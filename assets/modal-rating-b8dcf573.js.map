{"version":3,"file":"modal-rating-b8dcf573.js","sources":["../../src/js/modal-rating.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { patchRequest } from './api-energy-flow';\nimport '@fortawesome/fontawesome-free/css/all.min.css';\nlet currentDataId; // глобальна змінна для запиту\n\n// відкриття та закриття + отримання поточного дата айді\n\n(() => {\n  const refs = {\n    closeModalBtnRaiting: document.querySelector('.modal-raiting-close-btn'),\n    modalRaiting: document.querySelector('.modal-raiting-wrapper'),\n  };\n\n  document.addEventListener('click', event => {\n    if (event.target.classList.contains('rating-button')) {\n      currentDataId = event.target.dataset.action;\n      toggleModal();\n    }\n  });\n\n  refs.closeModalBtnRaiting.addEventListener('click', toggleModal);\n\n  function toggleModal() {\n    refs.modalRaiting.classList.toggle('is-hidden-rating');\n  }\n})();\n\n// stars rairing\n\nconst stars = document.querySelectorAll('.stars i');\n\nstars.forEach((star, index1) => {\n  star.addEventListener('click', () => {\n    stars.forEach((star, index2) => {\n      if (index1 >= index2) {\n        star.classList.add('active');\n        star.setAttribute('data-value', index1 + 1);\n      } else {\n        star.classList.remove('active');\n        star.removeAttribute('data-value');\n      }\n    });\n  });\n});\n\n// відправка на сервер логіка\nconst formRaiting = document.querySelector('.ratingForm');\nconst textarea = formRaiting.querySelector('textarea');\n\nformRaiting.addEventListener('input', e => {\n  const formRaitingData = new FormData(formRaiting);\n  const formRaitingArr = {};\n\n  formRaitingData.forEach((value, key) => {\n    formRaitingArr[key] = value;\n  });\n});\n\nformRaiting.addEventListener('submit', e => {\n  e.preventDefault();\n  const ratingValue = formRaiting\n    .querySelector('.stars i.active')\n    .getAttribute('data-value');\n  const ratingEmailValue = formRaiting.querySelector(\n    'input[name=\"emailInput\"]'\n  ).value;\n  const ratingComentValue = textarea.value;\n\n  const ratingDataObject = {\n    rate: parseInt(ratingValue, 10),\n    email: ratingEmailValue,\n    review: ratingComentValue,\n  };\n\n  raitingSubmitDataToServer(ratingDataObject, currentDataId);\n  console.log(ratingDataObject);\n});\n\nasync function raitingSubmitDataToServer(data, currentDataId) {\n  const url = `/exercises/${currentDataId}/rating`;\n  if (data.rate === '' || data.email === '' || data.review === '') {\n    iziToast.warning({\n      title: 'Caution',\n      message: 'Please enter form!',\n      position: 'topRight',\n    });\n    return;\n  }\n  console.log('currentDataId:', currentDataId);\n  try {\n    const response = await patchRequest(url, data);\n    if (response.status === 200) {\n      formRaiting.reset();\n      iziToast.success({\n        title: 'Success',\n        message: 'Operation completed successfully.',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    if (error.response && error.response.status === 409) {\n      iziToast.error({\n        title: 'Conflict',\n        message:\n          'Operation failed due to a conflict. Please check the data and try again.',\n        position: 'topRight',\n      });\n    } else {\n      iziToast.warning({\n        title: 'Caution',\n        message: error.message,\n        position: 'topRight',\n      });\n    }\n  }\n}\n"],"names":["currentDataId","refs","event","toggleModal","stars","star","index1","index2","formRaiting","textarea","e","value","key","ratingValue","ratingEmailValue","ratingComentValue","ratingDataObject","raitingSubmitDataToServer","data","url","iziToast","patchRequest","error"],"mappings":"sGAIA,IAAIA,GAIH,IAAM,CACL,MAAMC,EAAO,CACX,qBAAsB,SAAS,cAAc,0BAA0B,EACvE,aAAc,SAAS,cAAc,wBAAwB,CACjE,EAEE,SAAS,iBAAiB,QAASC,GAAS,CACtCA,EAAM,OAAO,UAAU,SAAS,eAAe,IACjDF,EAAgBE,EAAM,OAAO,QAAQ,OACrCC,IAEN,CAAG,EAEDF,EAAK,qBAAqB,iBAAiB,QAASE,CAAW,EAE/D,SAASA,GAAc,CACrBF,EAAK,aAAa,UAAU,OAAO,kBAAkB,CACtD,CACH,KAIA,MAAMG,EAAQ,SAAS,iBAAiB,UAAU,EAElDA,EAAM,QAAQ,CAACC,EAAMC,IAAW,CAC9BD,EAAK,iBAAiB,QAAS,IAAM,CACnCD,EAAM,QAAQ,CAACC,EAAME,IAAW,CAC1BD,GAAUC,GACZF,EAAK,UAAU,IAAI,QAAQ,EAC3BA,EAAK,aAAa,aAAcC,EAAS,CAAC,IAE1CD,EAAK,UAAU,OAAO,QAAQ,EAC9BA,EAAK,gBAAgB,YAAY,EAEzC,CAAK,CACL,CAAG,CACH,CAAC,EAGD,MAAMG,EAAc,SAAS,cAAc,aAAa,EAClDC,EAAWD,EAAY,cAAc,UAAU,EAErDA,EAAY,iBAAiB,QAASE,GAAK,CACjB,IAAI,SAASF,CAAW,EAGhC,QAAQ,CAACG,EAAOC,IAAQ,CAE1C,CAAG,CACH,CAAC,EAEDJ,EAAY,iBAAiB,SAAUE,GAAK,CAC1CA,EAAE,eAAc,EAChB,MAAMG,EAAcL,EACjB,cAAc,iBAAiB,EAC/B,aAAa,YAAY,EACtBM,EAAmBN,EAAY,cACnC,0BACD,EAAC,MACIO,EAAoBN,EAAS,MAE7BO,EAAmB,CACvB,KAAM,SAASH,EAAa,EAAE,EAC9B,MAAOC,EACP,OAAQC,CACZ,EAEEE,EAA0BD,EAAkBhB,CAAa,EACzD,QAAQ,IAAIgB,CAAgB,CAC9B,CAAC,EAED,eAAeC,EAA0BC,EAAMlB,EAAe,CAC5D,MAAMmB,EAAM,cAAcnB,CAAa,UACvC,GAAIkB,EAAK,OAAS,IAAMA,EAAK,QAAU,IAAMA,EAAK,SAAW,GAAI,CAC/DE,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,qBACT,SAAU,UAChB,CAAK,EACD,MACD,CACD,QAAQ,IAAI,iBAAkBpB,CAAa,EAC3C,GAAI,EACe,MAAMqB,EAAaF,EAAKD,CAAI,GAChC,SAAW,MACtBV,EAAY,MAAK,EACjBY,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oCACT,SAAU,UAClB,CAAO,EAEJ,OAAQE,EAAO,CACVA,EAAM,UAAYA,EAAM,SAAS,SAAW,IAC9CF,EAAS,MAAM,CACb,MAAO,WACP,QACE,2EACF,SAAU,UAClB,CAAO,EAEDA,EAAS,QAAQ,CACf,MAAO,UACP,QAASE,EAAM,QACf,SAAU,UAClB,CAAO,CAEJ,CACH"}